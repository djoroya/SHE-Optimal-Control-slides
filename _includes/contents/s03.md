<section>

{% include title.md content="4. Problema de control óptimo" %}

<section>
    <p>
    El problema de control se puede escribir como:
    $$ \min_{u(\tau) \in \mathcal{U}} \Big(\|{\alpha}(\pi)\|^2 + \|  {\beta}(\pi)\|^2 \Big) $$
    </p>
    <p>sujeto a:
    $$
        \forall i \in \mathcal{E}_a\ \ 
        \begin{cases}
            \dot{\alpha}_i(\tau) = -(2/\pi) \cos(i\tau) u(\tau) & \tau \in [0,\pi]\\
            \alpha_i(0) = a_T^i
        \end{cases} 
    $$
    $$
        \forall j \in \mathcal{E}_b\ \ 
        \begin{cases}
            \dot{\beta}_j(\tau) = -(2/\pi) \sin(j\tau) u(\tau) & \tau \in [0,\pi]\\
            \beta_j(0) =  b_T^i
        \end{cases} \\
    $$
    </p>
</section>

<section>
    <p>
    Tomando la notación
    $$
    \mathcal{D}^\alpha_i(\tau) = (2/\pi) \cos(j\tau)
    $$
    $$
    \mathcal{D}^\beta_j(\tau) = (2/\pi) \sin(j\tau)
    $$
    </p>
    <p> 
    Entonces podemos construir los vectores \(\mathcal{D}^\alpha\) y \(\mathcal{D}^\beta\) como:
    $$
    \mathcal{D}^\alpha(\tau) = 
    [\mathcal{D}^\alpha_1(\tau),\mathcal{D}^\alpha_3(\tau),\mathcal{D}^\alpha_5(\tau), \dots ]
    $$
    $$
    \mathcal{D}^\beta(\tau) = [\mathcal{D}^\beta_1(\tau),\mathcal{D}^\beta_3(\tau),\mathcal{D}^\alpha_5(\tau), \dots ]
    $$
    </p>
</section>
<!--  -->

<section>
    <p>El problema de control se puede escribir como:
    $$
    \min_{u(\tau) \in \mathcal{U}} \Big(\|{\alpha}(\pi)\|^2 + \|  {\beta}(\pi)\|^2 \Big)
    $$
    </p>
    <p>
    sujeto a:
    $$
    \begin{cases}
            \dot{\alpha}(\tau) = -\mathcal{D}_\alpha(\tau) u(\tau) & \tau \in [0,\pi]\\
            \alpha(0) = a_T
    \end{cases}
    $$
    $$
    \begin{cases}
            \dot{\beta}(\tau) = -\mathcal{D}_\beta(\tau) u(\tau) & \tau \in [0,\pi]\\
            \beta(0) = b_T
    \end{cases}
    $$
    </p>
</section>


<section>
    <p>Podemos reducir aún más la ecuación mediante la siguiente notación:
    $$ \mathcal{D}(\tau) = [\mathcal{D}_\alpha(\tau) \ \mathcal{D}_\beta(\tau) ]$$
    $$ x(\tau) = [\alpha(\tau) \ \beta(\tau)] $$
    </p>
    <p>Por tanto: 
    $$ x_0 = [a_T \ \ b_T] $$
    </p>
</section>
<!--  -->
<section>
    <p>
    El problema de control se puede escribir como:  
    $$ \min_{u(\tau) \in \mathcal{U}} \|x(\pi)\|^2  $$
    </p>
    <p>sujeto a:
    $$
    \begin{cases}
            \dot{x}(\tau) = -\mathcal{D}(\tau) u(\tau) & \tau \in [0,\pi]\\
            x(0) = x_0
    \end{cases}
    $$
    </p>
    <p style="color:red">¡Donde el control debe tomar valores en el conjunto finito \(\mathcal{U}\)!</p>
</section>
<!--  -->
<section>
<p>Es conocido que un problema de control sin término de penalización tiene muchas soluciones y que se puede buscar un control concreto añadiendo este término.</p>
<p>Por esta razón en este caso añadiremos un término de penalización tal que en el limite en el que el término desaparece el control obtenido es el que tiene las carácteristicas buscadas</p>

</section>
<section>
<p>
    Entonces el problema de control que consideraremos es:
    $$ \min_{u(\tau) \in \textcolor{red}{[-1,1]}} \|x(\pi)\|^2 + \textcolor{red}{\epsilon} \int_0^T \textcolor{red}{\mathcal{L}(u(\tau))}dt $$
    </p>
    <p>sujeto a:
    $$
    \begin{cases}
            \dot{x}(\tau) = -\mathcal{D}(\tau) u(\tau) & \tau \in [0,\pi]\\
            x(0) = x_0
    \end{cases}
    $$
    Entonces cuando \(\epsilon \rightarrow 0 \) el problema planteado controlará el sistema. Pero debemos buscar condiciones para \(\mathcal{L}\) para que esto suceda.
</p>
</section>
<section>
    <p>En este caso las condiciones de optimalidad de primer orden, vienen dadas por el principio de mínimo de Pontryagin. Para ello es necesario definir el Hamiltoniano del problema, en este caso:
    $$
    H(u,p,\tau) = [p^T \cdot \mathcal{D}(\tau)] u + \epsilon\mathcal{L}(u)
    $$
    </p>
    <p>donde \(p\) es el estado adjunto. Este se puede obtener como: 
    $$
    \begin{cases}
        \dot{p}(\tau) = -\nabla_x H(u,p,\tau) \\
        \dot{p}(\pi)  = -2 x(\pi)
    \end{cases} \rightarrow
    p(\tau) = -2 x(\pi) \ \  \forall \tau \in [0,\pi)
    $$
    El estado adjunto \(p(\tau)\) es constante en el tiempo.
    </p>
</section>
<section>
    <p>Debemos notar que \([p^T \cdot \mathcal{D}(\tau)] \) es un escalar compuesta por una combinación lineal de senos y cosenos. Concretamente:
    $$ [p^T \cdot \mathcal{D}(\tau)]  = \sum_{i \in \mathcal{E}_a} p_{\alpha}\cos(j\tau) +  \sum_{i \in \mathcal{E}_a} p_{\beta}\sin(j\tau) $$
    $$ \forall \tau \in [0,\pi]$$
    </p>
    <p>De manera que podemos notar que \([p^T \cdot \mathcal{D}(\tau)] \)  es un escalar que puede tomar valores negativos y positivos.</p>
</section>
<section>
    <p>
    Por otra parte, la forma del control óptimo \(u^*(\tau)\) viene dada por la siguiente condición 
    $$
    u^*(\tau) = \min_{u \in [-1,+1]} H(u,p^*,\tau)
    $$
    Remplazando el Hamiltoniano en la expresión anterior:
    $$
    u^*(\tau) = \min_{u \in [-1,+1]} \big[ [p^* \cdot \mathcal{D}(\tau)] u + \epsilon\mathcal{L}(u) \big]
    $$
    Donde remplazaremos  \([p^* \cdot \mathcal{D}(\tau)] \) por la letra \(m \in \mathbb{R}\) 
    </p>
</section>
<section>
<p>Entonces necesitamos que \(\forall m\) los mínimos de la función \(H^*(u)\) <b >SOLO</b> sean los elementos de \(\mathcal{U}\):
$$ 
\min_{u\in [-1,1]}H^*(u) = \min_{u\in [-1,1]} \big[ m u + \epsilon\mathcal{L}(u) \big]
$$
Donde considaremos \(\tau\) fijo.
</p>
</section>
<section>
<p>Si llamamos \(N_u\) a la cardinalidad del conjunto \(\mathcal{U} = \{u_1,u_2,\dots,u_{N_u}\}\), podemos proponer el siguiente término de penalización:
$$ \mathcal{L}(u) = \prod_{k=1}^{N_u - 1} \chi_{(u_k,u_{k+1})} recta(u_k,u_{k+1})$$
Este termino es una aproximación afin de una parábola, cuyos vertices son los elementos de \(\mathcal{U}\)</p>

</section>
<section>
<p>En el caso \(\mathcal{U} = \{-1.0,-0.5,0.0,0.5,1.0\}\)</p>
<img width="60%" src="{{site.url}}{{site.baseurl}}/img/10.png">
</section>


<section>
<p>En el caso \(\mathcal{U} = \{-1.0,-0.5,0.0,0.5,1.0\}\)</p>
<img width="60%" src="{{site.url}}{{site.baseurl}}/img/9.png">
</section>

<section>
<p>Ejemplo:</p>
<ul>
    <li>\(\mathcal{E}_a = \{\emptyset \}\) y \(\mathcal{E}_b = \{1,3,7,13,15 \}\)</li>
    <li>\(\mathcal{U} = \{-1,-1/2,\ 0 \ ,+1/2,+1\}\)</li>
    <li>\(b_T = [m,0,0,0,0] \ \forall m \in [-0.8,0.8]\) </li>
</ul>
</section>
<section>
<p>Ejemplo:</p>
<img width="60%" src="{{site.url}}{{site.baseurl}}/img/11.png">
</section>
</section>

